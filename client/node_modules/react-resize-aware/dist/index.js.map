{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["//\n// react-resize-aware component\n//\n// Triggers a `resize` event everytime the component changes its sizes\n// MIT License\n// Copyright 2016, Federico Zivolo\n//\n\nimport {\n  createElement,\n  Component,\n  Children,\n  cloneElement,\n  isValidElement,\n} from 'react';\n\nconst style = {\n  display: 'block',\n  position: 'absolute',\n  top: 0,\n  left: 0,\n  height: '100%',\n  width: '100%',\n  overflow: 'hidden',\n  pointerEvents: 'none',\n  zIndex: -1,\n};\n\nexport default class ResizeAware extends Component {\n  static defaultProps = {\n    component: 'div',\n    // don't define here the defaults to avoid to break\n    // the render result of previous versions\n    // TODO: use defaultProps to define default values\n    widthPropName: undefined,\n    heightPropName: undefined,\n  };\n  state = {};\n\n  // Init the resizeElement\n  componentDidMount() {\n    this.resizeElement.data = 'about:blank';\n  }\n\n  // Called when the object is loaded\n  handleObjectLoad = evt => {\n    this.setState(\n      {\n        resizeTarget: evt.target.contentDocument.defaultView,\n      },\n      () => {\n        this.state.resizeTarget.addEventListener('resize', this.handleResize);\n        this.handleResize();\n      }\n    );\n  };\n\n  componentWillUnmount() {\n    this.state.resizeTarget &&\n      this.state.resizeTarget.removeEventListener('resize', this.handleResize);\n  }\n\n  // Function called on component resize\n  handleResize = () => {\n    const sizes = {\n      width: this.container.offsetWidth,\n      height: this.container.offsetHeight,\n    };\n    this.setState(sizes);\n    this.props.onResize && this.props.onResize(sizes);\n  };\n\n  render() {\n    const {\n      children,\n      onResize,\n      onlyEvent,\n      component,\n      widthPropName,\n      heightPropName,\n      ...props\n    } = this.props;\n    const { width, height } = this.state;\n\n    const hasCustomComponent = typeof component !== 'string';\n\n    const widthProp = [widthPropName || 'width'];\n    const heightProp = [heightPropName || 'height'];\n\n    const sizes = {\n      [widthProp]: width,\n      [heightProp]: height,\n    };\n\n    return createElement(\n      component,\n      {\n        [hasCustomComponent ? 'getRef' : 'ref']: el => (this.container = el),\n        ...(hasCustomComponent && sizes),\n        ...props,\n      },\n      createElement('object', {\n        type: 'text/html',\n        style,\n        ref: el => (this.resizeElement = el),\n        onLoad: this.handleObjectLoad,\n        'aria-hidden': true,\n        tabIndex: -1,\n      }),\n      typeof children === 'function'\n        ? children({ width, height })\n        : Children.map(\n            children,\n            child =>\n              isValidElement(child)\n                ? cloneElement(child, !onlyEvent ? sizes : null)\n                : child\n          )\n    );\n  }\n}\n\nexport function makeResizeAware(component) {\n  return props => createElement(ResizeAware, { component, ...props });\n}\n"],"names":["style","ResizeAware","state","handleObjectLoad","setState","evt","target","contentDocument","defaultView","resizeTarget","addEventListener","handleResize","sizes","container","offsetWidth","offsetHeight","props","onResize","resizeElement","data","removeEventListener","children","onlyEvent","component","widthPropName","heightPropName","width","height","hasCustomComponent","widthProp","heightProp","createElement","el","Children","map","isValidElement","child","cloneElement","Component","defaultProps","undefined","makeResizeAware"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,AAQA,IAAMA,QAAQ;WACH,OADG;YAEF,UAFE;OAGP,CAHO;QAIN,CAJM;UAKJ,MALI;SAML,MANK;YAOF,QAPE;iBAQG,MARH;UASJ,CAAC;CATX;;IAYqBC;;;;;;;;;;;;;;gMASnBC,QAAQ,UAQRC,mBAAmB,eAAO;YACnBC,QAAL,CACE;sBACgBC,IAAIC,MAAJ,CAAWC,eAAX,CAA2BC;OAF7C,EAIE,YAAM;cACCN,KAAL,CAAWO,YAAX,CAAwBC,gBAAxB,CAAyC,QAAzC,EAAmD,MAAKC,YAAxD;cACKA,YAAL;OANJ;aAiBFA,eAAe,YAAM;UACbC,QAAQ;eACL,MAAKC,SAAL,CAAeC,WADV;gBAEJ,MAAKD,SAAL,CAAeE;OAFzB;YAIKX,QAAL,CAAcQ,KAAd;YACKI,KAAL,CAAWC,QAAX,IAAuB,MAAKD,KAAL,CAAWC,QAAX,CAAoBL,KAApB,CAAvB;;;;;;;;;wCA7BkB;WACbM,aAAL,CAAmBC,IAAnB,GAA0B,aAA1B;;;;;;;2CAgBqB;WAChBjB,KAAL,CAAWO,YAAX,IACE,KAAKP,KAAL,CAAWO,YAAX,CAAwBW,mBAAxB,CAA4C,QAA5C,EAAsD,KAAKT,YAA3D,CADF;;;;;;;6BAcO;;;;mBASH,KAAKK,KATF;UAELK,QAFK,UAELA,QAFK;UAGLJ,QAHK,UAGLA,QAHK;UAILK,SAJK,UAILA,SAJK;UAKLC,SALK,UAKLA,SALK;UAMLC,aANK,UAMLA,aANK;UAOLC,cAPK,UAOLA,cAPK;UAQFT,KARE;;mBAUmB,KAAKd,KAVxB;UAUCwB,KAVD,UAUCA,KAVD;UAUQC,MAVR,UAUQA,MAVR;;;UAYDC,qBAAqB,OAAOL,SAAP,KAAqB,QAAhD;;UAEMM,YAAY,CAACL,iBAAiB,OAAlB,CAAlB;UACMM,aAAa,CAACL,kBAAkB,QAAnB,CAAnB;;UAEMb,8CACHiB,SADG,EACSH,KADT,2BAEHI,UAFG,EAEUH,MAFV,UAAN;;aAKOI,oBACLR,SADK,+BAGFK,qBAAqB,QAArB,GAAgC,KAH9B,EAGsC;eAAO,OAAKf,SAAL,GAAiBmB,EAAxB;OAHtC,GAICJ,sBAAsBhB,KAJvB,EAKAI,KALA,GAOLe,oBAAc,QAAd,EAAwB;cAChB,WADgB;oBAAA;aAGjB;iBAAO,OAAKb,aAAL,GAAqBc,EAA5B;SAHiB;gBAId,KAAK7B,gBAJS;uBAKP,IALO;kBAMZ,CAAC;OANb,CAPK,EAeL,OAAOkB,QAAP,KAAoB,UAApB,GACIA,SAAS,EAAEK,YAAF,EAASC,cAAT,EAAT,CADJ,GAEIM,eAASC,GAAT,CACEb,QADF,EAEE;eACEc,qBAAeC,KAAf,IACIC,mBAAaD,KAAb,EAAoB,CAACd,SAAD,GAAaV,KAAb,GAAqB,IAAzC,CADJ,GAEIwB,KAHN;OAFF,CAjBC,CAAP;;;;;EAlEqCE;;AAApBrC,YACZsC,eAAe;aACT,KADS;;;;iBAKLC,SALK;kBAMJA;;AAuFpB,AAAO,SAASC,eAAT,CAAyBlB,SAAzB,EAAoC;SAClC;WAASQ,oBAAc9B,WAAd,aAA6BsB,oBAA7B,IAA2CP,KAA3C,EAAT;GAAP;;;;;;;;"}